用户扫码付款：

1. 调用 下单api 统一下单 ，返回支付地址(code_url)
2. 支付地址转二维码，注意：二维码的有效时间为2小时。
3. 轮询订单的状态，并对订单做相应处理。





扫用户支付码收款：

扫码获得 用户付款码。

生成订单，并调用 微信api（pay） 提交订单。

获得返回信息：1. 支付成功，处理订单并展示付款成功页面

2. 等待付款，轮询查该订单的状态
3. 超时仍未支付，结束轮询，并关闭订单
4.  支付失败，检查参数并重新发起支付。











参考资料：

https://juejin.im/post/6844903497301753869

轻轻一扫，立刻扣款，付款码背后的原理你不想知道吗？ - 小五教编程的文章 - 知乎 https://zhuanlan.zhihu.com/p/131346742